(base) âœ  core-new git:(main) âœ— target/debug/core_test_alice --data-dir /tmp/alice-test
ğŸŸ¦ Alice: Starting Core pairing test
ğŸ“ Alice: Data dir: /tmp/alice-test
ğŸ”§ Alice: Initializing Core...
âœ… Alice: Core initialized successfully
ğŸŒ Alice: Initializing networking...
ğŸ”§ Transport: Using TCP-only configuration (no QUIC) for connection stability
ğŸ”§ mDNS: Using default configuration for compatibility with working test
ğŸ”§ Request-Response: Configured 30s request timeout to prevent timeouts
ğŸ”§ Transport: Using TCP-only configuration (no QUIC) for connection stability
ğŸ”§ mDNS: Using default configuration for compatibility with working test
ğŸ”§ Request-Response: Configured 30s request timeout to prevent timeouts
âœ… Alice: Networking initialized successfully
ğŸ”‘ Alice: Starting pairing as initiator...
Started pairing session: 39bf9524-f18f-c2c6-16bd-537ae613e016
Kademlia mode changed: Server
Listening on: /ip4/127.0.0.1/tcp/63198
Current listening addresses: []
No external addresses found, using fallback
Listening on: /ip4/10.0.0.41/tcp/63198
Publishing DHT record with query ID: QueryId(0)
Published pairing session to DHT: session=39bf9524-f18f-c2c6-16bd-537ae613e016, query_id=QueryId(0)
DHT record publish failed: query_id=QueryId(0), key=Key(b"9\xbf\x95$\xf1\x8f\xc2\xc6\x16\xbdSz\xe6\x13\xe0\x16"), success=[], quorum=1
âœ… Alice: Pairing code generated: modify sound glare... (expires in 300s)
ğŸ“ Alice: Pairing code written to /tmp/spacedrive-pairing-test/pairing_code.txt
â³ Alice: Waiting for pairing to complete...
ğŸ” Alice: Pairing status check 1 - 1 sessions
ğŸ“Š Alice: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: WaitingForConnection, remote_device_id: None, shared_secret: None, created_at: 2025-06-23T06:46:51.375679Z }
Discovered peer via mDNS: 12D3KooWErdnwxSvjXqijLWJQkPK6rSv2Gzq12RSxLNJwVx1oQc6 at /ip4/10.0.0.41/tcp/58666/p2p/12D3KooWErdnwxSvjXqijLWJQkPK6rSv2Gzq12RSxLNJwVx1oQc6
Added peer 12D3KooWErdnwxSvjXqijLWJQkPK6rSv2Gzq12RSxLNJwVx1oQc6 to Kademlia routing table with address /ip4/10.0.0.41/tcp/58666/p2p/12D3KooWErdnwxSvjXqijLWJQkPK6rSv2Gzq12RSxLNJwVx1oQc6
Bootstrapping Kademlia DHT with query ID: QueryId(1)
ğŸ” Found waiting session 39bf9524-f18f-c2c6-16bd-537ae613e016 (Alice side) - not scheduling request
ğŸ” mDNS Discovery: Found 1 active sessions but none in Scanning state
Discovered peer via mDNS: 12D3KooWL4KsjJBUfcwgrj1PbhyByNvuraXofnY3Bf1AMHGdDnnD at /ip4/10.0.0.41/tcp/58647/p2p/12D3KooWL4KsjJBUfcwgrj1PbhyByNvuraXofnY3Bf1AMHGdDnnD
Added peer 12D3KooWL4KsjJBUfcwgrj1PbhyByNvuraXofnY3Bf1AMHGdDnnD to Kademlia routing table with address /ip4/10.0.0.41/tcp/58647/p2p/12D3KooWL4KsjJBUfcwgrj1PbhyByNvuraXofnY3Bf1AMHGdDnnD
Bootstrapping Kademlia DHT with query ID: QueryId(2)
ğŸ” Found waiting session 39bf9524-f18f-c2c6-16bd-537ae613e016 (Alice side) - not scheduling request
ğŸ” mDNS Discovery: Found 1 active sessions but none in Scanning state
Kademlia routing updated: peer=12D3KooWErdnwxSvjXqijLWJQkPK6rSv2Gzq12RSxLNJwVx1oQc6
Kademlia routing updated: peer=12D3KooWL4KsjJBUfcwgrj1PbhyByNvuraXofnY3Bf1AMHGdDnnD
ğŸ” Alice: Pairing status check 2 - 1 sessions
ğŸ“Š Alice: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: WaitingForConnection, remote_device_id: None, shared_secret: None, created_at: 2025-06-23T06:46:51.375679Z }
ğŸ” Alice: Pairing status check 3 - 1 sessions
ğŸ“Š Alice: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: WaitingForConnection, remote_device_id: None, shared_secret: None, created_at: 2025-06-23T06:46:51.375679Z }
ğŸ” Alice: Pairing status check 4 - 1 sessions
ğŸ“Š Alice: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: WaitingForConnection, remote_device_id: None, shared_secret: None, created_at: 2025-06-23T06:46:51.375679Z }
ğŸ” Alice: Pairing status check 5 - 1 sessions
ğŸ“Š Alice: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: WaitingForConnection, remote_device_id: None, shared_secret: None, created_at: 2025-06-23T06:46:51.375679Z }
Discovered peer via mDNS: 12D3KooWBQmBN3WC6p2cz1NXfDCnSVcxwJEYpD48wwbKU2FzPqWs at /ip4/10.0.0.41/tcp/63201/p2p/12D3KooWBQmBN3WC6p2cz1NXfDCnSVcxwJEYpD48wwbKU2FzPqWs
Added peer 12D3KooWBQmBN3WC6p2cz1NXfDCnSVcxwJEYpD48wwbKU2FzPqWs to Kademlia routing table with address /ip4/10.0.0.41/tcp/63201/p2p/12D3KooWBQmBN3WC6p2cz1NXfDCnSVcxwJEYpD48wwbKU2FzPqWs
Bootstrapping Kademlia DHT with query ID: QueryId(3)
ğŸ” Found waiting session 39bf9524-f18f-c2c6-16bd-537ae613e016 (Alice side) - not scheduling request
ğŸ” mDNS Discovery: Found 1 active sessions but none in Scanning state
Kademlia routing updated: peer=12D3KooWBQmBN3WC6p2cz1NXfDCnSVcxwJEYpD48wwbKU2FzPqWs
Connection established with: 12D3KooWBQmBN3WC6p2cz1NXfDCnSVcxwJEYpD48wwbKU2FzPqWs at /ip4/10.0.0.41/tcp/63201/p2p/12D3KooWBQmBN3WC6p2cz1NXfDCnSVcxwJEYpD48wwbKU2FzPqWs
Added connected peer 12D3KooWBQmBN3WC6p2cz1NXfDCnSVcxwJEYpD48wwbKU2FzPqWs to Kademlia routing table
Received pairing request from 12D3KooWBQmBN3WC6p2cz1NXfDCnSVcxwJEYpD48wwbKU2FzPqWs
ğŸ”¥ ALICE: Received pairing request from device f17e9577-8eb6-43d1-9043-878a3df63623 for session 39bf9524-f18f-c2c6-16bd-537ae613e016
ğŸ”¥ ALICE: Generated challenge of 32 bytes for session 39bf9524-f18f-c2c6-16bd-537ae613e016
Transitioning existing session 39bf9524-f18f-c2c6-16bd-537ae613e016 from WaitingForConnection to ChallengeReceived
ğŸ”¥ ALICE: Sending Challenge response for session 39bf9524-f18f-c2c6-16bd-537ae613e016 with 32 byte challenge
Sent pairing response to 12D3KooWBQmBN3WC6p2cz1NXfDCnSVcxwJEYpD48wwbKU2FzPqWs
Other Kademlia event: InboundRequest { request: FindNode { num_closer_peers: 2 } }
Other Kademlia event: InboundRequest { request: GetRecord { num_closer_peers: 2, present_locally: true } }
ğŸ” Alice: Pairing status check 6 - 1 sessions
ğŸ“Š Alice: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: ChallengeReceived { challenge: [47, 22, 148, 255, 64, 87, 205, 56, 167, 65, 233, 45, 25, 53, 82, 127, 120, 78, 226, 69, 110, 191, 29, 176, 215, 109, 118, 254, 66, 148, 95, 162] }, remote_device_id: Some(f17e9577-8eb6-43d1-9043-878a3df63623), shared_secret: None, created_at: 2025-06-23T06:46:51.375679Z }
ğŸ” Alice: Pairing status check 7 - 1 sessions
ğŸ“Š Alice: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: ChallengeReceived { challenge: [47, 22, 148, 255, 64, 87, 205, 56, 167, 65, 233, 45, 25, 53, 82, 127, 120, 78, 226, 69, 110, 191, 29, 176, 215, 109, 118, 254, 66, 148, 95, 162] }, remote_device_id: Some(f17e9577-8eb6-43d1-9043-878a3df63623), shared_secret: None, created_at: 2025-06-23T06:46:51.375679Z }
ğŸ” Alice: Pairing status check 8 - 1 sessions
ğŸ“Š Alice: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: ChallengeReceived { challenge: [47, 22, 148, 255, 64, 87, 205, 56, 167, 65, 233, 45, 25, 53, 82, 127, 120, 78, 226, 69, 110, 191, 29, 176, 215, 109, 118, 254, 66, 148, 95, 162] }, remote_device_id: Some(f17e9577-8eb6-43d1-9043-878a3df63623), shared_secret: None, created_at: 2025-06-23T06:46:51.375679Z }
Other Kademlia event: InboundRequest { request: GetRecord { num_closer_peers: 2, present_locally: true } }
ğŸ” Alice: Pairing status check 9 - 1 sessions
ğŸ“Š Alice: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: ChallengeReceived { challenge: [47, 22, 148, 255, 64, 87, 205, 56, 167, 65, 233, 45, 25, 53, 82, 127, 120, 78, 226, 69, 110, 191, 29, 176, 215, 109, 118, 254, 66, 148, 95, 162] }, remote_device_id: Some(f17e9577-8eb6-43d1-9043-878a3df63623), shared_secret: None, created_at: 2025-06-23T06:46:51.375679Z }
ğŸ” Alice: Pairing status check 10 - 1 sessions
ğŸ“Š Alice: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: ChallengeReceived { challenge: [47, 22, 148, 255, 64, 87, 205, 56, 167, 65, 233, 45, 25, 53, 82, 127, 120, 78, 226, 69, 110, 191, 29, 176, 215, 109, 118, 254, 66, 148, 95, 162] }, remote_device_id: Some(f17e9577-8eb6-43d1-9043-878a3df63623), shared_secret: None, created_at: 2025-06-23T06:46:51.375679Z }
ğŸ” Alice: Pairing status check 11 - 1 sessions
ğŸ“Š Alice: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: ChallengeReceived { challenge: [47, 22, 148, 255, 64, 87, 205, 56, 167, 65, 233, 45, 25, 53, 82, 127, 120, 78, 226, 69, 110, 191, 29, 176, 215, 109, 118, 254, 66, 148, 95, 162] }, remote_device_id: Some(f17e9577-8eb6-43d1-9043-878a3df63623), shared_secret: None, created_at: 2025-06-23T06:46:51.375679Z }
Other Kademlia event: OutboundQueryProgressed { id: QueryId(1), result: Bootstrap(Ok(BootstrapOk { peer: PeerId("12D3KooWG4mPRmqBGfoHagX549fC3WjMFNPNujQDVQXcAiPYUL8A"), num_remaining: 3 })), stats: QueryStats { requests: 1, success: 0, failure: 0, start: Some(Instant { tv_sec: 36695, tv_nsec: 497366291 }), end: Some(Instant { tv_sec: 36706, tv_nsec: 183395625 }) }, step: ProgressStep { count: 1, last: false } }
Other Kademlia event: OutboundQueryProgressed { id: QueryId(2), result: Bootstrap(Ok(BootstrapOk { peer: PeerId("12D3KooWG4mPRmqBGfoHagX549fC3WjMFNPNujQDVQXcAiPYUL8A"), num_remaining: 3 })), stats: QueryStats { requests: 2, success: 0, failure: 0, start: Some(Instant { tv_sec: 36695, tv_nsec: 497366291 }), end: Some(Instant { tv_sec: 36706, tv_nsec: 185212916 }) }, step: ProgressStep { count: 1, last: false } }
Other Kademlia event: InboundRequest { request: GetRecord { num_closer_peers: 2, present_locally: true } }
ğŸ” Alice: Pairing status check 12 - 1 sessions
ğŸ“Š Alice: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: ChallengeReceived { challenge: [47, 22, 148, 255, 64, 87, 205, 56, 167, 65, 233, 45, 25, 53, 82, 127, 120, 78, 226, 69, 110, 191, 29, 176, 215, 109, 118, 254, 66, 148, 95, 162] }, remote_device_id: Some(f17e9577-8eb6-43d1-9043-878a3df63623), shared_secret: None, created_at: 2025-06-23T06:46:51.375679Z }
ğŸ” Alice: Pairing status check 13 - 1 sessions
ğŸ“Š Alice: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: ChallengeReceived { challenge: [47, 22, 148, 255, 64, 87, 205, 56, 167, 65, 233, 45, 25, 53, 82, 127, 120, 78, 226, 69, 110, 191, 29, 176, 215, 109, 118, 254, 66, 148, 95, 162] }, remote_device_id: Some(f17e9577-8eb6-43d1-9043-878a3df63623), shared_secret: None, created_at: 2025-06-23T06:46:51.375679Z }
ğŸ” Alice: Pairing status check 14 - 1 sessions
ğŸ“Š Alice: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: ChallengeReceived { challenge: [47, 22, 148, 255, 64, 87, 205, 56, 167, 65, 233, 45, 25, 53, 82, 127, 120, 78, 226, 69, 110, 191, 29, 176, 215, 109, 118, 254, 66, 148, 95, 162] }, remote_device_id: Some(f17e9577-8eb6-43d1-9043-878a3df63623), shared_secret: None, created_at: 2025-06-23T06:46:51.375679Z }
Other Kademlia event: InboundRequest { request: GetRecord { num_closer_peers: 2, present_locally: true } }
ğŸ” Alice: Pairing status check 15 - 1 sessions
ğŸ“Š Alice: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: ChallengeReceived { challenge: [47, 22, 148, 255, 64, 87, 205, 56, 167, 65, 233, 45, 25, 53, 82, 127, 120, 78, 226, 69, 110, 191, 29, 176, 215, 109, 118, 254, 66, 148, 95, 162] }, remote_device_id: Some(f17e9577-8eb6-43d1-9043-878a3df63623), shared_secret: None, created_at: 2025-06-23T06:46:51.375679Z }
ğŸ” Alice: Pairing status check 16 - 1 sessions
ğŸ“Š Alice: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: ChallengeReceived { challenge: [47, 22, 148, 255, 64, 87, 205, 56, 167, 65, 233, 45, 25, 53, 82, 127, 120, 78, 226, 69, 110, 191, 29, 176, 215, 109, 118, 254, 66, 148, 95, 162] }, remote_device_id: Some(f17e9577-8eb6-43d1-9043-878a3df63623), shared_secret: None, created_at: 2025-06-23T06:46:51.375679Z }
ğŸ” Alice: Pairing status check 17 - 1 sessions
ğŸ“Š Alice: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: ChallengeReceived { challenge: [47, 22, 148, 255, 64, 87, 205, 56, 167, 65, 233, 45, 25, 53, 82, 127, 120, 78, 226, 69, 110, 191, 29, 176, 215, 109, 118, 254, 66, 148, 95, 162] }, remote_device_id: Some(f17e9577-8eb6-43d1-9043-878a3df63623), shared_secret: None, created_at: 2025-06-23T06:46:51.375679Z }
ğŸ” Alice: Pairing status check 18 - 1 sessions
ğŸ“Š Alice: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: ChallengeReceived { challenge: [47, 22, 148, 255, 64, 87, 205, 56, 167, 65, 233, 45, 25, 53, 82, 127, 120, 78, 226, 69, 110, 191, 29, 176, 215, 109, 118, 254, 66, 148, 95, 162] }, remote_device_id: Some(f17e9577-8eb6-43d1-9043-878a3df63623), shared_secret: None, created_at: 2025-06-23T06:46:51.375679Z }
ğŸ” Alice: Pairing status check 19 - 1 sessions
ğŸ“Š Alice: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: ChallengeReceived { challenge: [47, 22, 148, 255, 64, 87, 205, 56, 167, 65, 233, 45, 25, 53, 82, 127, 120, 78, 226, 69, 110, 191, 29, 176, 215, 109, 118, 254, 66, 148, 95, 162] }, remote_device_id: Some(f17e9577-8eb6-43d1-9043-878a3df63623), shared_secret: None, created_at: 2025-06-23T06:46:51.375679Z }
ğŸ” Alice: Pairing status check 20 - 1 sessions
ğŸ“Š Alice: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: ChallengeReceived { challenge: [47, 22, 148, 255, 64, 87, 205, 56, 167, 65, 233, 45, 25, 53, 82, 127, 120, 78, 226, 69, 110, 191, 29, 176, 215, 109, 118, 254, 66, 148, 95, 162] }, remote_device_id: Some(f17e9577-8eb6-43d1-9043-878a3df63623), shared_secret: None, created_at: 2025-06-23T06:46:51.375679Z }
ğŸ” Alice: Pairing status check 21 - 1 sessions
ğŸ“Š Alice: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: ChallengeReceived { challenge: [47, 22, 148, 255, 64, 87, 205, 56, 167, 65, 233, 45, 25, 53, 82, 127, 120, 78, 226, 69, 110, 191, 29, 176, 215, 109, 118, 254, 66, 148, 95, 162] }, remote_device_id: Some(f17e9577-8eb6-43d1-9043-878a3df63623), shared_secret: None, created_at: 2025-06-23T06:46:51.375679Z }
ğŸ” Alice: Pairing status check 22 - 1 sessions
ğŸ“Š Alice: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: ChallengeReceived { challenge: [47, 22, 148, 255, 64, 87, 205, 56, 167, 65, 233, 45, 25, 53, 82, 127, 120, 78, 226, 69, 110, 191, 29, 176, 215, 109, 118, 254, 66, 148, 95, 162] }, remote_device_id: Some(f17e9577-8eb6-43d1-9043-878a3df63623), shared_secret: None, created_at: 2025-06-23T06:46:51.375679Z }
ğŸ” Alice: Pairing status check 23 - 1 sessions
ğŸ“Š Alice: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: ChallengeReceived { challenge: [47, 22, 148, 255, 64, 87, 205, 56, 167, 65, 233, 45, 25, 53, 82, 127, 120, 78, 226, 69, 110, 191, 29, 176, 215, 109, 118, 254, 66, 148, 95, 162] }, remote_device_id: Some(f17e9577-8eb6-43d1-9043-878a3df63623), shared_secret: None, created_at: 2025-06-23T06:46:51.375679Z }
ğŸ” Alice: Pairing status check 24 - 1 sessions
ğŸ“Š Alice: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: ChallengeReceived { challenge: [47, 22, 148, 255, 64, 87, 205, 56, 167, 65, 233, 45, 25, 53, 82, 127, 120, 78, 226, 69, 110, 191, 29, 176, 215, 109, 118, 254, 66, 148, 95, 162] }, remote_device_id: Some(f17e9577-8eb6-43d1-9043-878a3df63623), shared_secret: None, created_at: 2025-06-23T06:46:51.375679Z }
Other Kademlia event: OutboundQueryProgressed { id: QueryId(1), result: Bootstrap(Ok(BootstrapOk { peer: PeerId("1AeUcz6gnipR99YtoN4rtbyR8HDr8peaDheY47JQGHtaDX"), num_remaining: 2 })), stats: QueryStats { requests: 3, success: 1, failure: 0, start: Some(Instant { tv_sec: 36706, tv_nsec: 185212916 }), end: Some(Instant { tv_sec: 36719, tv_nsec: 192071750 }) }, step: ProgressStep { count: 2, last: false } }
Other Kademlia event: OutboundQueryProgressed { id: QueryId(3), result: Bootstrap(Ok(BootstrapOk { peer: PeerId("12D3KooWG4mPRmqBGfoHagX549fC3WjMFNPNujQDVQXcAiPYUL8A"), num_remaining: 3 })), stats: QueryStats { requests: 3, success: 1, failure: 0, start: Some(Instant { tv_sec: 36699, tv_nsec: 672690333 }), end: Some(Instant { tv_sec: 36719, tv_nsec: 193044208 }) }, step: ProgressStep { count: 1, last: false } }
Other Kademlia event: OutboundQueryProgressed { id: QueryId(2), result: Bootstrap(Ok(BootstrapOk { peer: PeerId("1AZA5RBsqbtSsPHw7zNbJiEEFByFaAV2sVNLQDHQmU5heX"), num_remaining: 2 })), stats: QueryStats { requests: 3, success: 1, failure: 0, start: Some(Instant { tv_sec: 36706, tv_nsec: 187386208 }), end: Some(Instant { tv_sec: 36719, tv_nsec: 194937083 }) }, step: ProgressStep { count: 2, last: false } }
Connection closed with 12D3KooWBQmBN3WC6p2cz1NXfDCnSVcxwJEYpD48wwbKU2FzPqWs: Some(IO(Custom { kind: Other, error: Error(Right(Closed)) }))
ğŸ” Alice: Pairing status check 25 - 1 sessions
ğŸ“Š Alice: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: ChallengeReceived { challenge: [47, 22, 148, 255, 64, 87, 205, 56, 167, 65, 233, 45, 25, 53, 82, 127, 120, 78, 226, 69, 110, 191, 29, 176, 215, 109, 118, 254, 66, 148, 95, 162] }, remote_device_id: Some(f17e9577-8eb6-43d1-9043-878a3df63623), shared_secret: None, created_at: 2025-06-23T06:46:51.375679Z }
ğŸ” Alice: Pairing status check 26 - 1 sessions
ğŸ“Š Alice: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: ChallengeReceived { challenge: [47, 22, 148, 255, 64, 87, 205, 56, 167, 65, 233, 45, 25, 53, 82, 127, 120, 78, 226, 69, 110, 191, 29, 176, 215, 109, 118, 254, 66, 148, 95, 162] }, remote_device_id: Some(f17e9577-8eb6-43d1-9043-878a3df63623), shared_secret: None, created_at: 2025-06-23T06:46:51.375679Z }
ğŸ” Alice: Pairing status check 27 - 1 sessions
ğŸ“Š Alice: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: ChallengeReceived { challenge: [47, 22, 148, 255, 64, 87, 205, 56, 167, 65, 233, 45, 25, 53, 82, 127, 120, 78, 226, 69, 110, 191, 29, 176, 215, 109, 118, 254, 66, 148, 95, 162] }, remote_device_id: Some(f17e9577-8eb6-43d1-9043-878a3df63623), shared_secret: None, created_at: 2025-06-23T06:46:51.375679Z }
ğŸ” Alice: Pairing status check 28 - 1 sessions
ğŸ“Š Alice: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: ChallengeReceived { challenge: [47, 22, 148, 255, 64, 87, 205, 56, 167, 65, 233, 45, 25, 53, 82, 127, 120, 78, 226, 69, 110, 191, 29, 176, 215, 109, 118, 254, 66, 148, 95, 162] }, remote_device_id: Some(f17e9577-8eb6-43d1-9043-878a3df63623), shared_secret: None, created_at: 2025-06-23T06:46:51.375679Z }
ğŸ” Alice: Pairing status check 29 - 1 sessions
ğŸ“Š Alice: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: ChallengeReceived { challenge: [47, 22, 148, 255, 64, 87, 205, 56, 167, 65, 233, 45, 25, 53, 82, 127, 120, 78, 226, 69, 110, 191, 29, 176, 215, 109, 118, 254, 66, 148, 95, 162] }, remote_device_id: Some(f17e9577-8eb6-43d1-9043-878a3df63623), shared_secret: None, created_at: 2025-06-23T06:46:51.375679Z }
ğŸ” Alice: Pairing status check 30 - 1 sessions
ğŸ“Š Alice: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: ChallengeReceived { challenge: [47, 22, 148, 255, 64, 87, 205, 56, 167, 65, 233, 45, 25, 53, 82, 127, 120, 78, 226, 69, 110, 191, 29, 176, 215, 109, 118, 254, 66, 148, 95, 162] }, remote_device_id: Some(f17e9577-8eb6-43d1-9043-878a3df63623), shared_secret: None, created_at: 2025-06-23T06:46:51.375679Z }
âŒ Alice: Pairing timed out after 30 seconds
Error: "Pairing timeout"
(base) âœ  core-new git:(main) âœ—


----


(base) âœ  core-new git:(main) âœ— target/debug/core_test_bob --data-dir /tmp/bob-test
ğŸŸ¨ Bob: Starting Core pairing test
ğŸ“ Bob: Data dir: /tmp/bob-test
ğŸ”§ Bob: Initializing Core...
âœ… Bob: Core initialized successfully
ğŸŒ Bob: Initializing networking...
ğŸ”§ Transport: Using TCP-only configuration (no QUIC) for connection stability
ğŸ”§ mDNS: Using default configuration for compatibility with working test
ğŸ”§ Request-Response: Configured 30s request timeout to prevent timeouts
ğŸ”§ Transport: Using TCP-only configuration (no QUIC) for connection stability
ğŸ”§ mDNS: Using default configuration for compatibility with working test
ğŸ”§ Request-Response: Configured 30s request timeout to prevent timeouts
âœ… Bob: Networking initialized successfully
â³ Bob: Waiting for Alice's pairing code...
âœ… Bob: Found pairing code: modify sound glare...
ğŸ¤ Bob: Joining pairing with code...
Kademlia mode changed: Server
âœ… Joined pairing session: 39bf9524-f18f-c2c6-16bd-537ae613e016 (state: Scanning)
âœ… Bob's pairing session verified in Scanning state: 39bf9524-f18f-c2c6-16bd-537ae613e016
Bob joined Alice's pairing session: 39bf9524-f18f-c2c6-16bd-537ae613e016
âœ… Bob's session verified: 39bf9524-f18f-c2c6-16bd-537ae613e016 in state Scanning
â³ Waiting for mDNS discovery to trigger pairing requests...
Listening on: /ip4/127.0.0.1/tcp/63201
Listening on: /ip4/10.0.0.41/tcp/63201
Discovered peer via mDNS: 12D3KooWErdnwxSvjXqijLWJQkPK6rSv2Gzq12RSxLNJwVx1oQc6 at /ip4/10.0.0.41/tcp/58666/p2p/12D3KooWErdnwxSvjXqijLWJQkPK6rSv2Gzq12RSxLNJwVx1oQc6
Added peer 12D3KooWErdnwxSvjXqijLWJQkPK6rSv2Gzq12RSxLNJwVx1oQc6 to Kademlia routing table with address /ip4/10.0.0.41/tcp/58666/p2p/12D3KooWErdnwxSvjXqijLWJQkPK6rSv2Gzq12RSxLNJwVx1oQc6
Bootstrapping Kademlia DHT with query ID: QueryId(0)
ğŸ” Found scanning session 39bf9524-f18f-c2c6-16bd-537ae613e016 - scheduling pairing request for peer 12D3KooWErdnwxSvjXqijLWJQkPK6rSv2Gzq12RSxLNJwVx1oQc6 (waiting for connection)
âœ… mDNS Discovery: Scheduled pairing request for session 39bf9524-f18f-c2c6-16bd-537ae613e016 with peer 12D3KooWErdnwxSvjXqijLWJQkPK6rSv2Gzq12RSxLNJwVx1oQc6 (pending connection)
ğŸ” mDNS Discovery: Scheduled 1 pairing sessions for peer 12D3KooWErdnwxSvjXqijLWJQkPK6rSv2Gzq12RSxLNJwVx1oQc6 (waiting for connection)
Discovered peer via mDNS: 12D3KooWL4KsjJBUfcwgrj1PbhyByNvuraXofnY3Bf1AMHGdDnnD at /ip4/10.0.0.41/tcp/58647/p2p/12D3KooWL4KsjJBUfcwgrj1PbhyByNvuraXofnY3Bf1AMHGdDnnD
Added peer 12D3KooWL4KsjJBUfcwgrj1PbhyByNvuraXofnY3Bf1AMHGdDnnD to Kademlia routing table with address /ip4/10.0.0.41/tcp/58647/p2p/12D3KooWL4KsjJBUfcwgrj1PbhyByNvuraXofnY3Bf1AMHGdDnnD
Bootstrapping Kademlia DHT with query ID: QueryId(1)
ğŸ” Found scanning session 39bf9524-f18f-c2c6-16bd-537ae613e016 - scheduling pairing request for peer 12D3KooWL4KsjJBUfcwgrj1PbhyByNvuraXofnY3Bf1AMHGdDnnD (waiting for connection)
âœ… mDNS Discovery: Scheduled pairing request for session 39bf9524-f18f-c2c6-16bd-537ae613e016 with peer 12D3KooWL4KsjJBUfcwgrj1PbhyByNvuraXofnY3Bf1AMHGdDnnD (pending connection)
ğŸ” mDNS Discovery: Scheduled 1 pairing sessions for peer 12D3KooWL4KsjJBUfcwgrj1PbhyByNvuraXofnY3Bf1AMHGdDnnD (waiting for connection)
Discovered peer via mDNS: 12D3KooWG4mPRmqBGfoHagX549fC3WjMFNPNujQDVQXcAiPYUL8A at /ip4/10.0.0.41/tcp/63198/p2p/12D3KooWG4mPRmqBGfoHagX549fC3WjMFNPNujQDVQXcAiPYUL8A
Added peer 12D3KooWG4mPRmqBGfoHagX549fC3WjMFNPNujQDVQXcAiPYUL8A to Kademlia routing table with address /ip4/10.0.0.41/tcp/63198/p2p/12D3KooWG4mPRmqBGfoHagX549fC3WjMFNPNujQDVQXcAiPYUL8A
Bootstrapping Kademlia DHT with query ID: QueryId(2)
ğŸ” Found scanning session 39bf9524-f18f-c2c6-16bd-537ae613e016 - scheduling pairing request for peer 12D3KooWG4mPRmqBGfoHagX549fC3WjMFNPNujQDVQXcAiPYUL8A (waiting for connection)
âœ… mDNS Discovery: Scheduled pairing request for session 39bf9524-f18f-c2c6-16bd-537ae613e016 with peer 12D3KooWG4mPRmqBGfoHagX549fC3WjMFNPNujQDVQXcAiPYUL8A (pending connection)
ğŸ” mDNS Discovery: Scheduled 1 pairing sessions for peer 12D3KooWG4mPRmqBGfoHagX549fC3WjMFNPNujQDVQXcAiPYUL8A (waiting for connection)
Kademlia routing updated: peer=12D3KooWErdnwxSvjXqijLWJQkPK6rSv2Gzq12RSxLNJwVx1oQc6
Kademlia routing updated: peer=12D3KooWL4KsjJBUfcwgrj1PbhyByNvuraXofnY3Bf1AMHGdDnnD
Kademlia routing updated: peer=12D3KooWG4mPRmqBGfoHagX549fC3WjMFNPNujQDVQXcAiPYUL8A
Connection established with: 12D3KooWG4mPRmqBGfoHagX549fC3WjMFNPNujQDVQXcAiPYUL8A at /ip4/10.0.0.41/tcp/63198
Added connected peer 12D3KooWG4mPRmqBGfoHagX549fC3WjMFNPNujQDVQXcAiPYUL8A to Kademlia routing table
Connection established for pairing session: 39bf9524-f18f-c2c6-16bd-537ae613e016 with peer: 12D3KooWG4mPRmqBGfoHagX549fC3WjMFNPNujQDVQXcAiPYUL8A
Sent pairing request for session 39bf9524-f18f-c2c6-16bd-537ae613e016 with request ID: OutboundRequestId(1)
Other Kademlia event: InboundRequest { request: FindNode { num_closer_peers: 2 } }
Received pairing response from 12D3KooWG4mPRmqBGfoHagX549fC3WjMFNPNujQDVQXcAiPYUL8A
ğŸ”„ Starting unified pairing flow for session: 39bf9524-f18f-c2c6-16bd-537ae613e016
ğŸ“¡ mDNS pairing: Listening for local network discoveries...
ğŸŒ DHT pairing: Querying distributed hash table...
Querying DHT record with query ID: QueryId(3)
ğŸ” DHT Query initiated: session=39bf9524-f18f-c2c6-16bd-537ae613e016, query_id=QueryId(3)
âœ… Unified pairing flow initiated - waiting for responses from any method...
âœ… Bob: Successfully joined pairing
â³ Bob: Waiting for pairing to complete...
ğŸ” Bob: Pairing status check 1 - 1 sessions
ğŸ“Š Bob: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: Scanning, remote_device_id: None, shared_secret: None, created_at: 2025-06-23T06:46:55.551850Z }
DHT record found: query_id=QueryId(3), key=Key(b"9\xbf\x95$\xf1\x8f\xc2\xc6\x16\xbdSz\xe6\x13\xe0\x16"), 539 bytes
Found pairing advertisement from peer: "12D3KooWG4mPRmqBGfoHagX549fC3WjMFNPNujQDVQXcAiPYUL8A"
Emitted pairing session discovery event for session: 39bf9524-f18f-c2c6-16bd-537ae613e016
Dialing discovered peer 12D3KooWG4mPRmqBGfoHagX549fC3WjMFNPNujQDVQXcAiPYUL8A at /ip4/0.0.0.0/tcp/0
Tracking pending pairing connection for session: 39bf9524-f18f-c2c6-16bd-537ae613e016 -> peer: 12D3KooWG4mPRmqBGfoHagX549fC3WjMFNPNujQDVQXcAiPYUL8A
ğŸ” Bob: Pairing status check 2 - 1 sessions
ğŸ“Š Bob: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: Scanning, remote_device_id: None, shared_secret: None, created_at: 2025-06-23T06:46:55.551850Z }
ğŸ” Bob: Pairing status check 3 - 1 sessions
ğŸ“Š Bob: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: Scanning, remote_device_id: None, shared_secret: None, created_at: 2025-06-23T06:46:55.551850Z }
Querying DHT record with query ID: QueryId(4)
ğŸ”„ DHT Retry 1: session=39bf9524-f18f-c2c6-16bd-537ae613e016, query_id=QueryId(4)
ğŸ” Bob: Pairing status check 4 - 1 sessions
ğŸ“Š Bob: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: Scanning, remote_device_id: None, shared_secret: None, created_at: 2025-06-23T06:46:55.551850Z }
DHT record found: query_id=QueryId(4), key=Key(b"9\xbf\x95$\xf1\x8f\xc2\xc6\x16\xbdSz\xe6\x13\xe0\x16"), 539 bytes
Found pairing advertisement from peer: "12D3KooWG4mPRmqBGfoHagX549fC3WjMFNPNujQDVQXcAiPYUL8A"
Emitted pairing session discovery event for session: 39bf9524-f18f-c2c6-16bd-537ae613e016
Dialing discovered peer 12D3KooWG4mPRmqBGfoHagX549fC3WjMFNPNujQDVQXcAiPYUL8A at /ip4/0.0.0.0/tcp/0
Tracking pending pairing connection for session: 39bf9524-f18f-c2c6-16bd-537ae613e016 -> peer: 12D3KooWG4mPRmqBGfoHagX549fC3WjMFNPNujQDVQXcAiPYUL8A
ğŸ” Bob: Pairing status check 5 - 1 sessions
ğŸ“Š Bob: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: Scanning, remote_device_id: None, shared_secret: None, created_at: 2025-06-23T06:46:55.551850Z }
ğŸ” Bob: Pairing status check 6 - 1 sessions
ğŸ“Š Bob: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: Scanning, remote_device_id: None, shared_secret: None, created_at: 2025-06-23T06:46:55.551850Z }
Querying DHT record with query ID: QueryId(5)
ğŸ”„ DHT Retry 2: session=39bf9524-f18f-c2c6-16bd-537ae613e016, query_id=QueryId(5)
ğŸ” Bob: Pairing status check 7 - 1 sessions
ğŸ“Š Bob: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: Scanning, remote_device_id: None, shared_secret: None, created_at: 2025-06-23T06:46:55.551850Z }
DHT record found: query_id=QueryId(5), key=Key(b"9\xbf\x95$\xf1\x8f\xc2\xc6\x16\xbdSz\xe6\x13\xe0\x16"), 539 bytes
Found pairing advertisement from peer: "12D3KooWG4mPRmqBGfoHagX549fC3WjMFNPNujQDVQXcAiPYUL8A"
Emitted pairing session discovery event for session: 39bf9524-f18f-c2c6-16bd-537ae613e016
Dialing discovered peer 12D3KooWG4mPRmqBGfoHagX549fC3WjMFNPNujQDVQXcAiPYUL8A at /ip4/0.0.0.0/tcp/0
Tracking pending pairing connection for session: 39bf9524-f18f-c2c6-16bd-537ae613e016 -> peer: 12D3KooWG4mPRmqBGfoHagX549fC3WjMFNPNujQDVQXcAiPYUL8A
Other Kademlia event: InboundRequest { request: FindNode { num_closer_peers: 2 } }
Other Kademlia event: InboundRequest { request: FindNode { num_closer_peers: 2 } }
ğŸ” Bob: Pairing status check 8 - 1 sessions
ğŸ“Š Bob: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: Scanning, remote_device_id: None, shared_secret: None, created_at: 2025-06-23T06:46:55.551850Z }
ğŸ” Bob: Pairing status check 9 - 1 sessions
ğŸ“Š Bob: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: Scanning, remote_device_id: None, shared_secret: None, created_at: 2025-06-23T06:46:55.551850Z }
Querying DHT record with query ID: QueryId(6)
ğŸ”„ DHT Retry 3: session=39bf9524-f18f-c2c6-16bd-537ae613e016, query_id=QueryId(6)
ğŸ” Bob: Pairing status check 10 - 1 sessions
ğŸ“Š Bob: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: Scanning, remote_device_id: None, shared_secret: None, created_at: 2025-06-23T06:46:55.551850Z }
DHT record found: query_id=QueryId(6), key=Key(b"9\xbf\x95$\xf1\x8f\xc2\xc6\x16\xbdSz\xe6\x13\xe0\x16"), 539 bytes
Found pairing advertisement from peer: "12D3KooWG4mPRmqBGfoHagX549fC3WjMFNPNujQDVQXcAiPYUL8A"
Emitted pairing session discovery event for session: 39bf9524-f18f-c2c6-16bd-537ae613e016
Dialing discovered peer 12D3KooWG4mPRmqBGfoHagX549fC3WjMFNPNujQDVQXcAiPYUL8A at /ip4/0.0.0.0/tcp/0
Tracking pending pairing connection for session: 39bf9524-f18f-c2c6-16bd-537ae613e016 -> peer: 12D3KooWG4mPRmqBGfoHagX549fC3WjMFNPNujQDVQXcAiPYUL8A
ğŸ” Bob: Pairing status check 11 - 1 sessions
ğŸ“Š Bob: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: Scanning, remote_device_id: None, shared_secret: None, created_at: 2025-06-23T06:46:55.551850Z }
ğŸ” Bob: Pairing status check 12 - 1 sessions
ğŸ“Š Bob: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: Scanning, remote_device_id: None, shared_secret: None, created_at: 2025-06-23T06:46:55.551850Z }
ğŸ” Bob: Pairing status check 13 - 1 sessions
ğŸ“Š Bob: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: Scanning, remote_device_id: None, shared_secret: None, created_at: 2025-06-23T06:46:55.551850Z }
ğŸ” Bob: Pairing status check 14 - 1 sessions
ğŸ“Š Bob: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: Scanning, remote_device_id: None, shared_secret: None, created_at: 2025-06-23T06:46:55.551850Z }
ğŸ” Bob: Pairing status check 15 - 1 sessions
ğŸ“Š Bob: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: Scanning, remote_device_id: None, shared_secret: None, created_at: 2025-06-23T06:46:55.551850Z }
ğŸ” Bob: Pairing status check 16 - 1 sessions
ğŸ“Š Bob: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: Scanning, remote_device_id: None, shared_secret: None, created_at: 2025-06-23T06:46:55.551850Z }
ğŸ” Bob: Pairing status check 17 - 1 sessions
ğŸ“Š Bob: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: Scanning, remote_device_id: None, shared_secret: None, created_at: 2025-06-23T06:46:55.551850Z }
ğŸ” Bob: Pairing status check 18 - 1 sessions
ğŸ“Š Bob: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: Scanning, remote_device_id: None, shared_secret: None, created_at: 2025-06-23T06:46:55.551850Z }
ğŸ” Bob: Pairing status check 19 - 1 sessions
ğŸ“Š Bob: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: Scanning, remote_device_id: None, shared_secret: None, created_at: 2025-06-23T06:46:55.551850Z }
DHT query finished, no additional records: query_id=QueryId(5)
DHT query finished, no additional records: query_id=QueryId(4)
DHT query finished, no additional records: query_id=QueryId(6)
Other Kademlia event: OutboundQueryProgressed { id: QueryId(1), result: Bootstrap(Ok(BootstrapOk { peer: PeerId("12D3KooWBQmBN3WC6p2cz1NXfDCnSVcxwJEYpD48wwbKU2FzPqWs"), num_remaining: 1 })), stats: QueryStats { requests: 2, success: 0, failure: 0, start: Some(Instant { tv_sec: 36699, tv_nsec: 674731875 }), end: Some(Instant { tv_sec: 36719, tv_nsec: 191561958 }) }, step: ProgressStep { count: 1, last: false } }
Other Kademlia event: OutboundQueryProgressed { id: QueryId(0), result: Bootstrap(Ok(BootstrapOk { peer: PeerId("12D3KooWBQmBN3WC6p2cz1NXfDCnSVcxwJEYpD48wwbKU2FzPqWs"), num_remaining: 1 })), stats: QueryStats { requests: 1, success: 0, failure: 0, start: Some(Instant { tv_sec: 36699, tv_nsec: 674731875 }), end: Some(Instant { tv_sec: 36719, tv_nsec: 192752916 }) }, step: ProgressStep { count: 1, last: false } }
DHT query finished, no additional records: query_id=QueryId(3)
Other Kademlia event: OutboundQueryProgressed { id: QueryId(2), result: Bootstrap(Ok(BootstrapOk { peer: PeerId("12D3KooWBQmBN3WC6p2cz1NXfDCnSVcxwJEYpD48wwbKU2FzPqWs"), num_remaining: 1 })), stats: QueryStats { requests: 3, success: 0, failure: 1, start: Some(Instant { tv_sec: 36699, tv_nsec: 674731875 }), end: Some(Instant { tv_sec: 36719, tv_nsec: 194138416 }) }, step: ProgressStep { count: 1, last: false } }
Connection closed with 12D3KooWG4mPRmqBGfoHagX549fC3WjMFNPNujQDVQXcAiPYUL8A: Some(KeepAliveTimeout)
Pairing connection failed for session 39bf9524-f18f-c2c6-16bd-537ae613e016, retrying (1/3)
Scheduling retry for pairing session 39bf9524-f18f-c2c6-16bd-537ae613e016
ğŸ” Bob: Pairing status check 20 - 1 sessions
ğŸ“Š Bob: Session state: PairingSession { id: 39bf9524-f18f-c2c6-16bd-537ae613e016, state: Scanning, remote_device_id: None, shared_secret: None, created_at: 2025-06-23T06:46:55.551850Z }
âŒ Bob: Pairing timed out after 20 seconds
Event loop shutdown requested
Event loop stopped
Error: "Pairing timeout"
(base) âœ  core-new git:(main) âœ—